<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tutorial &#8212; nmrpeaklists 0.9 documentation</title>
    <link rel="stylesheet" href="_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scripts" href="scripts.html" />
    <link rel="prev" title="nmrpeaklists" href="index.html" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="shortcut icon" type="image/png" href="_static/favicon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=0.8">
    
    

  </head><body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="responsive-menu"><a href="#sidebar-anchor" title="Navigation">&#9776;</a></li>
        <li><a href="index.html">nmrpeaklists 0.9 documentation</a> &#187;</li> 
      </ul>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">nmrpeaklists</span></code> library can be used to read, write and edit NMR peak list files. It can also be used to convert between different peak list file formats. Currently, the library supports peak lists from NMRPipe and Sparky, and it can read peak lists in the XEASY and UPL formats.</p>
<p>The library was originally written to support data work flows involving CARA, CYANA and nlinLS. The <a class="reference internal" href="scripts.html#scripts"><span class="std std-ref">scripts</span></a> provided with the library reflect this fact. However, it can be used equally well to support any data flow involving the supported peak list formats.</p>
<p>In the following tutorial, the code blocks assume that the <code class="docutils literal notranslate"><span class="pre">nmrpeaklists</span></code> library has been imported with the following command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nmrpeaklists</span> <span class="kn">as</span> <span class="nn">npl</span>
</pre></div>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#data-structures" id="id1">Data structures</a><ul>
<li><a class="reference internal" href="#spin" id="id2">Spin</a></li>
<li><a class="reference internal" href="#peak" id="id3">Peak</a></li>
<li><a class="reference internal" href="#peaklist" id="id4">PeakList</a><ul>
<li><a class="reference internal" href="#dims" id="id5">dims</a></li>
<li><a class="reference internal" href="#anchors" id="id6">anchors</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#reading-peak-lists" id="id7">Reading peak lists</a><ul>
<li><a class="reference internal" href="#xeasy-format" id="id8">XEASY format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-peak-lists" id="id9">Writing peak lists</a></li>
<li><a class="reference internal" href="#modifying-a-peak-list" id="id10">Modifying a peak list</a><ul>
<li><a class="reference internal" href="#sorting" id="id11">Sorting</a></li>
<li><a class="reference internal" href="#filtering" id="id12">Filtering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#peak-attributes" id="id13">Peak attributes</a></li>
</ul>
</div>
<div class="section" id="data-structures">
<h2><a class="toc-backref" href="#id1">Data structures</a><a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">nmrpeaklists</span></code> library provides three data structures that aim to mimic the structure of a peak list. A <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> object represents an entire peak list and is composed of a sequence of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects. Each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> object represents a single line in a peak list and is composed of a sequence of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects.</p>
<div class="section" id="spin">
<h3><a class="toc-backref" href="#id2">Spin</a><a class="headerlink" href="#spin" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> object is a container that holds attributes of a particular NMR spin resonance. A peak in an N-dimensional NMR spectrum is associated with N different spin resonances. <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects aggregate attributes of the associated spin resonances, like chemical shift, assignment, line width, etc. The following three attributes are pre-defined for each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> object:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>res_type</td>
<td>Residue type</td>
</tr>
<tr class="row-odd"><td>res_num</td>
<td>Residue number or spin system number</td>
</tr>
<tr class="row-even"><td>atom</td>
<td>Atom name</td>
</tr>
</tbody>
</table>
<p>Other attributes may be added to <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects as necessary. The following table provides a list of suggested attribute names for some common spin parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>shift</td>
<td>Chemical shift</td>
</tr>
<tr class="row-odd"><td>shift_pts</td>
<td>Chemical shift in number of points (spectrum specific)</td>
</tr>
<tr class="row-even"><td>width</td>
<td>Line width of the peak in the corresponding dimension</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> attributes can be set upon initializing the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> or added to the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> after creation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spin</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">spin</span><span class="p">)</span>
<span class="go">Spin(atom=&#39;N&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin</span><span class="o">.</span><span class="n">res_num</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">spin</span><span class="p">)</span>
<span class="go">Spin(res_num=15, atom=&#39;N&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="peak">
<h3><a class="toc-backref" href="#id3">Peak</a><a class="headerlink" href="#peak" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> object represents a single line in a peak list. It can be treated as a mutable sequence of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects and can be used like any normal Python list. To initialize a <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> object, use the keyword argument <code class="docutils literal notranslate"><span class="pre">spins</span></code> to provide a list of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spins</span> <span class="o">=</span> <span class="p">[</span><span class="n">npl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="n">atom</span><span class="p">)</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;HA&#39;</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">Peak</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">spins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">atom</span> <span class="k">for</span> <span class="n">spin</span> <span class="ow">in</span> <span class="n">peak</span><span class="p">]</span>
<span class="go">[&#39;H&#39;, &#39;N&#39;, &#39;HA&#39;, &#39;CA&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">peak</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">atom</span> <span class="k">for</span> <span class="n">spin</span> <span class="ow">in</span> <span class="n">peak</span><span class="p">]</span>
<span class="go">[&#39;H&#39;, &#39;CA&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">npl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;HB&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">atom</span> <span class="k">for</span> <span class="n">spin</span> <span class="ow">in</span> <span class="n">peak</span><span class="p">]</span>
<span class="go">[&#39;H&#39;, &#39;CA&#39;, &#39;HB&#39;]</span>
</pre></div>
</div>
<p>Each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> object may have additional attributes that relate to the peak as a whole. For example, <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects created from XEASY files usually have a <code class="docutils literal notranslate"><span class="pre">volume</span></code> attribute, whereas <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects created from UPL files have a <code class="docutils literal notranslate"><span class="pre">distance</span></code> attribute. Furthermore, arbitrary attributes may be added to each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> as needed. For example, when processing CEST data, users may want to add a <code class="docutils literal notranslate"><span class="pre">CEST_profile</span></code> attribute to each peak. Additional attributes can be added as keyword arguments at initialization or as attributes after the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> has been created.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">Peak</span><span class="p">(</span><span class="n">volume</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span><span class="o">.</span><span class="n">CEST_profile</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span><span class="o">.</span><span class="n">volume</span>
<span class="go">50000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span><span class="o">.</span><span class="n">CEST_profile</span>
<span class="go">[0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only the NMRPipe and Sparky formats are flexible enough to write any arbitrary Peak attribute to a file. See <a href="#id14"><span class="problematic" id="id15">`Column Templates`_</span></a> for more information.</p>
</div>
</div>
<div class="section" id="peaklist">
<h3><a class="toc-backref" href="#id4">PeakList</a><a class="headerlink" href="#peaklist" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> objects are mutable sequences of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects and can be used as if they were Python lists.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">peaklist</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaklist</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">peak</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">peaklist</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span><span class="o">.</span><span class="n">volume</span>
<span class="go">50000</span>
</pre></div>
</div>
<p>Just like <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects, <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> objects also have attributes representing properties belonging to the peak list as a whole. The following attributes are pre-defined and are calculated by each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> object:</p>
<div class="section" id="dims">
<h4><a class="toc-backref" href="#id5">dims</a><a class="headerlink" href="#dims" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">dims</span></code> attribute is an integer specifying the number of dimensions in the peak list. It corresponds to the number of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects in each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> object of the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a>. An <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> is raised if the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> is empty or if any two <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects in the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> contain a different number of <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects. The following should always be true for a non-empty <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">peaklist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span><span class="o">.</span><span class="n">dims</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">peak</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="anchors">
<h4><a class="toc-backref" href="#id6">anchors</a><a class="headerlink" href="#anchors" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">anchors</span></code> attribute specifies which dimensions of the peak list correspond to spin anchors. A spin anchor is a directly attached proton/heavy atom pair. Each spin anchor is represented by a tuple of two integers, where the integers are indices into <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects to extract the two corresponding <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects that form the spin anchor. The index of the proton spin always comes first. The <code class="docutils literal notranslate"><span class="pre">anchors</span></code> attribute of a <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> is a list of tuples indicating the spin anchors. Only one anchor is possible in 2D and 3D peak lists, but two anchors are possible in 4D peak lists.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span><span class="o">.</span><span class="n">anchors</span>
<span class="go">[(2, 0)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anchor</span> <span class="o">=</span> <span class="n">peaklist</span><span class="o">.</span><span class="n">anchors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">peaklist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anchored_spins</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">anchor</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">spin</span><span class="o">.</span><span class="n">res_num</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">atom</span><span class="p">)</span> <span class="k">for</span> <span class="n">spin</span> <span class="ow">in</span> <span class="n">anchored_spins</span><span class="p">]</span>
<span class="go">[(41, &#39;HD1&#39;), (41, &#39;CD1&#39;)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reading-peak-lists">
<h2><a class="toc-backref" href="#id7">Reading peak lists</a><a class="headerlink" href="#reading-peak-lists" title="Permalink to this headline">¶</a></h2>
<p>For each supported peak list file format, there exists a corresponding subclass of the <code class="xref py py-class docutils literal notranslate"><span class="pre">PeakListFile</span></code> class.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File format</th>
<th class="head">Subclass</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>NMRPipe</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">PipeFile</span></code></td>
</tr>
<tr class="row-odd"><td>Sparky</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkyFile</span></code></td>
</tr>
<tr class="row-even"><td>XEASY</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">XeasyFile</span></code></td>
</tr>
<tr class="row-odd"><td>UPL</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">UplFile</span></code></td>
</tr>
</tbody>
</table>
<p>To read a peak list file, create an object of the appropriate subclass and run its <code class="xref py py-class docutils literal notranslate"><span class="pre">read_peaklist</span></code> method. These two steps can be performed in one line.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">XeasyFile</span><span class="p">()</span><span class="o">.</span><span class="n">read_peaklist</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, if you need to modify the object before reading the peak list, you can perform the two actions separately.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaklistfile</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">XeasyFile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span> <span class="o">=</span> <span class="n">peaklistfile</span><span class="o">.</span><span class="n">read_peaklist</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>Objects of <code class="xref py py-class docutils literal notranslate"><span class="pre">PeakListFile</span></code> subclasses are usually only edited when the corresponding file type is customizable, i.e. columns in the peak list can be added, removed and rearranged. This is accomplished by modifying the object’s <a class="reference internal" href="modules/columns.html#nmrpeaklists.columns.ColumnTemplate" title="nmrpeaklists.columns.ColumnTemplate"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColumnTemplate</span></code></a>. For more information, see <a href="#id16"><span class="problematic" id="id17">`Column Templates`_</span></a>.</p>
<div class="section" id="xeasy-format">
<h3><a class="toc-backref" href="#id8">XEASY format</a><a class="headerlink" href="#xeasy-format" title="Permalink to this headline">¶</a></h3>
<p>The XEASY peak list format provides a set of spin IDs for each peak, but it does not include any assignment data directly. Assignment data can only be obtained by referencing each spin ID against a mapping of spin IDs to their respective assignments. Consequently, users must perform an extra step when reading XEASY peak lists in order to incorporate assignment data.</p>
<p>The mapping between spin IDs and spin assignments can be provided in several different forms. The standard approach uses a sequence file and atom list to create the mapping. Alternatively, if the spin IDs relate to a CARA repository, then users can create the mapping as a single file using the <span class="xref std std-ref">Lua script</span> provided with this library. Finally, if the XEASY peak list is an anchor peak list from CARA, then the peak list itself contains the assignment data as comments interleaved within the data.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">AssignmentFile</span></code> class defines an interface for this mapping. Subclasses of <code class="xref py py-class docutils literal notranslate"><span class="pre">AssignmentFile</span></code> are specific to each file or set of files used to create the mapping. The data is read from the file(s) using the <code class="xref py py-class docutils literal notranslate"><span class="pre">AssignmentFile</span></code> method <code class="xref py py-class docutils literal notranslate"><span class="pre">read_file</span></code>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File(s)</th>
<th class="head">Subclass</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Atom list &amp; Seq file</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomListSeqFile</span></code></td>
</tr>
<tr class="row-odd"><td>CARA spin ID file</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">CaraSpinsFile</span></code></td>
</tr>
<tr class="row-even"><td>CARA anchor peak list</td>
<td><code class="xref py py-class docutils literal notranslate"><span class="pre">CaraAnchorFile</span></code></td>
</tr>
</tbody>
</table>
<p>Objects of <code class="xref py py-class docutils literal notranslate"><span class="pre">AssignmentFile</span></code> subclasses can be used directly, as if they were a dictionary mapping spin ID values to <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Assignment" title="nmrpeaklists.peaklist.Assignment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Assignment</span></code></a> tuples. When the XEASY peak list is read, each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> in the <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> is given a <code class="docutils literal notranslate"><span class="pre">spin_id</span></code> attribute. The <code class="xref py py-class docutils literal notranslate"><span class="pre">AssignmentFile</span></code> method <code class="xref py py-class docutils literal notranslate"><span class="pre">assign_peaklist</span></code> takes a <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> and sets the <code class="docutils literal notranslate"><span class="pre">res_type</span></code>, <code class="docutils literal notranslate"><span class="pre">res_num</span></code> and <code class="docutils literal notranslate"><span class="pre">atom</span></code> attributes for each <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> based on its <code class="docutils literal notranslate"><span class="pre">spin_id</span></code> attribute.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">XeasyFile</span><span class="p">()</span><span class="o">.</span><span class="n">read_peaklist</span><span class="p">(</span><span class="n">peaklist_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin</span> <span class="o">=</span> <span class="n">peaklist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">spin</span><span class="o">.</span><span class="n">res_type</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">res_num</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">atom</span><span class="p">)</span>
<span class="go">(None, None, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin</span><span class="o">.</span><span class="n">spin_id</span>
<span class="go">194</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assignments</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">CaraSpinsFile</span><span class="p">()</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">spins_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assignments</span><span class="p">[</span><span class="mi">194</span><span class="p">]</span>
<span class="go">Assignment(res_type=&#39;H&#39;, res_num=43, atom=&#39;HA&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span> <span class="o">=</span> <span class="n">assignments</span><span class="o">.</span><span class="n">assign_peaklist</span><span class="p">(</span><span class="n">peaklist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">spin</span><span class="o">.</span><span class="n">res_type</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">res_num</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">atom</span><span class="p">)</span>
<span class="go">(&#39;H&#39;, 43, &#39;HA&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="writing-peak-lists">
<h2><a class="toc-backref" href="#id9">Writing peak lists</a><a class="headerlink" href="#writing-peak-lists" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="modifying-a-peak-list">
<h2><a class="toc-backref" href="#id10">Modifying a peak list</a><a class="headerlink" href="#modifying-a-peak-list" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sorting">
<h3><a class="toc-backref" href="#id11">Sorting</a><a class="headerlink" href="#sorting" title="Permalink to this headline">¶</a></h3>
<p>To facilitate sorting a <code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code> by its <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> assignments, <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Spin" title="nmrpeaklists.peaklist.Spin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spin</span></code></a> objects may be compared to each other with the comparison operators (&lt;, &lt;=, &gt; and &gt;=). These comparisons are only influenced by the assignment data, not by any other attributes of the spins. The default sorting order is by residue number, then sidechain position and finally atom name. Unassigned spins are always sorted last.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spin1</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">res_num</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;HB&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin2</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">res_num</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;HD1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin1</span> <span class="o">&lt;</span> <span class="n">spin2</span>
<span class="go">True</span>
</pre></div>
</div>
<p><a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.Peak" title="nmrpeaklists.peaklist.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">Peak</span></code></a> objects may also be compared using the comparison operators, and once again, only the assignment data influences sorting. The default behavior for peaks sorts them as tuples of their respective spins. As a result, the order of the peak list dimensions (i.e. the order of spins in each peak) matters greatly when sorting peaks. This is especially evident in NOESY peak lists.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spin1</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">res_num</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;HG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin2</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">res_num</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;HA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak1</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Peak</span><span class="p">([</span><span class="n">spin1</span><span class="p">,</span> <span class="n">spin2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin3</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">res_num</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;HG2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spin4</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">res_num</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak2</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Peak</span><span class="p">([</span><span class="n">spin3</span><span class="p">,</span> <span class="n">spin4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak1</span> <span class="o">&lt;</span> <span class="n">peak2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">peak1</span><span class="p">,</span> <span class="n">peak2</span><span class="p">])</span>
<span class="go">[Peak(spins=</span>
<span class="go">[Spin(res_num=14, atom=&#39;HG2&#39;),</span>
<span class="go"> Spin(res_num=63, atom=&#39;H&#39;)]), Peak(spins=</span>
<span class="go">[Spin(res_num=28, atom=&#39;HG&#39;),</span>
<span class="go"> Spin(res_num=17, atom=&#39;HA&#39;)])]</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">sort_by_assignment</span></code> <a class="reference internal" href="modules/peaklist.html#nmrpeaklists.peaklist.PeakList" title="nmrpeaklists.peaklist.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeakList</span></code></a> method to change the default sort order. By default, <code class="docutils literal notranslate"><span class="pre">sort_by_assignment</span></code> takes into account the spin anchors, but it still gives the highest sorting priority to the lowest-index Spins. Alternatively, you can manually specify the sort order using the <code class="docutils literal notranslate"><span class="pre">order</span></code> keyword argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaklist</span><span class="o">.</span><span class="n">sort_by_assignments</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">peaklist</span>
<span class="go">PeakList(peaks=</span>
<span class="go">[Peak(spins=</span>
<span class="go">[Spin(res_num=28, atom=&#39;HG&#39;),</span>
<span class="go"> Spin(res_num=17, atom=&#39;HA&#39;)]),</span>
<span class="go"> Peak(spins=</span>
<span class="go">[Spin(res_num=14, atom=&#39;HG2&#39;),</span>
<span class="go"> Spin(res_num=63, atom=&#39;H&#39;)])])</span>
</pre></div>
</div>
</div>
<div class="section" id="filtering">
<h3><a class="toc-backref" href="#id12">Filtering</a><a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="peak-attributes">
<h2><a class="toc-backref" href="#id13">Peak attributes</a><a class="headerlink" href="#peak-attributes" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="sidebar-anchor"></a>
    

  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#data-structures">Data structures</a><ul>
<li><a class="reference internal" href="#spin">Spin</a></li>
<li><a class="reference internal" href="#peak">Peak</a></li>
<li><a class="reference internal" href="#peaklist">PeakList</a><ul>
<li><a class="reference internal" href="#dims">dims</a></li>
<li><a class="reference internal" href="#anchors">anchors</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#reading-peak-lists">Reading peak lists</a><ul>
<li><a class="reference internal" href="#xeasy-format">XEASY format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-peak-lists">Writing peak lists</a></li>
<li><a class="reference internal" href="#modifying-a-peak-list">Modifying a peak list</a><ul>
<li><a class="reference internal" href="#sorting">Sorting</a></li>
<li><a class="reference internal" href="#filtering">Filtering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#peak-attributes">Peak attributes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">nmrpeaklists</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scripts.html"
                        title="next chapter">Scripts</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scripts.html" title="Scripts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="nmrpeaklists"
             accesskey="P">previous</a> |</li>
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Bradley Harden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>